{% extends "base.html" %}
{% block content %}
<h3 class="text-black mb-3">My Appointments</h3>

<ul class="nav nav-tabs mb-3" id="doctorTabs" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="upcoming-tab" data-bs-toggle="tab" data-bs-target="#upcoming-pane" type="button" role="tab">
      Upcoming
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="past-tab" data-bs-toggle="tab" data-bs-target="#past-pane" type="button" role="tab">
      Past
    </button>
  </li>
</ul>

<div class="tab-content" id="doctorTabsContent">
  <div class="tab-pane fade show active" id="upcoming-pane" role="tabpanel" aria-labelledby="upcoming-tab">
    {% if upcoming %}
      <div class="list-group">
        {% for a in upcoming %}
        <div class="list-group-item d-flex justify-content-between align-items-start">
          <div>
            <div class="fw-bold">
              {{ a.date }} • {{ a.patient.get_full_name|default:a.patient.username }}
            </div>
            <div class="small text-muted">
              Reason: {{ a.reason }}
            </div>
          </div>
          <div class="ms-3 d-flex flex-column gap-2">
            <a href="{% url 'appointments:doctor_notes' a.pk %}" class="btn btn-outline-secondary btn-sm">
              Notes
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-muted">You have no upcoming confirmed appointments.</p>
    {% endif %}
  </div>

  <div class="tab-pane fade" id="past-pane" role="tabpanel" aria-labelledby="past-tab">
    {% if past %}
      <div class="list-group">
        {% for a in past %}
        <div class="list-group-item d-flex justify-content-between align-items-start">
          <div>
            <div class="fw-bold">
              {{ a.date }} • {{ a.patient.get_full_name|default:a.patient.username }}
            </div>
            <div class="small text-muted">
              Reason: {{ a.reason }}
            </div>
          </div>
          <div class="ms-3 d-flex flex-column gap-2">
            <a href="{% url 'appointments:doctor_notes' a.pk %}" class="btn btn-outline-secondary btn-sm">
              Notes
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="text-muted">No past confirmed appointments yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
